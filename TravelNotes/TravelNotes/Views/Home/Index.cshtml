@model List<usersArticleModel>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css">

@functions {
    public string FormatPublishTime(DateTime? publishTime)
    {
        if (!publishTime.HasValue)
            return "未知";

        var now = DateTime.Now;
        var difference = now.Subtract(publishTime.Value);

        if (difference.TotalDays >= 1)
            return $"{difference.Days} 天前";
        if (difference.TotalHours >= 1)
            return $"{difference.Hours} 小時前";
        if (difference.TotalMinutes >= 1)
            return $"{difference.Minutes} 分鐘前";

        return "剛剛";
    }
}

<style>
    .sticky-search-bar {
        position: sticky;
        top: 0;
        background-color: #F3E4C6;
        z-index: 1000;
        margin-left:auto;
        margin-right:auto;
        margin-top:5px;
        height:50px;
        
    }

    .input-icon-container {
        position: relative;
        display: inline-block;
        width: 100%;
        margin-top:3px;
    }

        .input-icon-container i {
            position: absolute;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            color: #ccc;
        }

    .parent {
        display: flex;
        justify-content: center;
        margin: 0;
        padding: 0;
    }

    .ArtCarForHome{
        padding: 2px;
        position: relative;
        background-color: white;
        border-radius: 10px;
        width: 95%;
    }

    .ParVie{
        margin: 10px;
        position: relative;
    }
    </style>
<div class="sticky-search-bar">
    <form asp-controller="Home" asp-action="Index" method="get">
        <div class="input-icon-container">
            <i class="bi bi-search"></i>
            <input type="text" name="search" placeholder="請輸入關鍵字" style="width:100%; border-radius: 30px; border: 0px solid #ccc; padding: 10px 40px;" />
        </div>
    </form>
</div>
<div>
    <hr />
    @if (Model != null && Model.Any())
    {

        @foreach (var item in Model)
        {
            <div class="parent">
                <div class="ArtCarForHome">
                    <div style="margin:10px;">
                        <div style="display:inline-block;">
                            <a href="/PersonalPage/PersonalPage?userId=@item.user.UserId" style="text-decoration: none; color: inherit;">
                                <img src="@item.user.Headshot" style="width:35px;height:35px;border-radius:50%;"></img>
                                @item.user.Nickname
                            </a>
                        </div>
                        <div style="display:inline-block; color: gray; font-size: 12px;">發佈時間: @FormatPublishTime(item.article.PublishTime)</div>
                    </div>
                    <div class="ParVie">
                        <a href="/Article/ArticleView?articleId=@item.article.ArticleId" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;"></a>
                        <partial name="ArticleCardForHome" model="item.article" />
                    </div>
                </div>
            </div>
            <br />
            <br />
        }     
    }
    else
    {
        <p>沒有找到類似的文章，請重新搜尋。</p>
    }
    
    
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            let url = new URL(window.location);
            if (url.searchParams.has('search')) {
                url.searchParams.delete('search');
                window.history.pushState({}, '', url);
            }
        });
        $(document).ready(function () {
            $('.ParVie').hover(
                function () {
                    // 鼠标进入
                    $(this).find('.partialViewTitle').css('text-decoration', 'underline');
                    $(this).find('.partialViewSubTitle').css('text-decoration', 'underline');
                    

                }, function () {
                    // 鼠标离开
                    $(this).find('.partialViewTitle').css('text-decoration', 'none');
                    $(this).find('.partialViewSubTitle').css('text-decoration', 'none');
                    
                }
            );
            $('.ArtCarForHome').hover(
                function () {
                    $(this).css('box-shadow', '0 4px 8px rgba(0, 0, 0, 0.5)');
                }, function () {
                    $(this).css('box-shadow', 'none');
                }
            );

        });
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('[data-publish-time]').forEach(function (element) {
                const publishTime = new Date(element.getAttribute('data-publish-time'));
                element.innerText = timeSince(publishTime) + '前';
            });
        });
        
        
        
    </script>
</div>